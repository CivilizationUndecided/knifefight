@using System.Text;
@namespace Facepunch.UI
@inherits Panel
@attribute [StyleSheet]

@if ( !Player.IsValid() ) return;

<root class="@BuildClass() hud flex row gap with-padding">

    <div class="flex column gap-xs">
        <span class="flex row align-center gap-sm">
            <Icon file="/ui/health.png" size="32" />
            <label class="emphasis">@Health</label>
        </span>
        <ProgressBar Value="@(Health)" width="128" />
    </div>

    <div class="flex column gap-xs">
        <span class="flex row align-center gap-sm">
            <Icon file="/ui/armor.png" size="32" />
            <label class="emphasis">@Armor</label>
        </span>
        <ProgressBar Value="@(Armor)" width="64" />
    </div>

</root>

@code
{
    public PlayerController Player => GameUtils.LocalPlayer;
    public int Health => Player.Components.Get<HealthComponent>().Health.CeilToInt();
    public int Armor => Player.Components.Get<HealthComponent>().Armor.CeilToInt();

    protected override int BuildHash()
    {
        return !Player.IsValid() ? 0 : HashCode.Combine( Health );
    }

    private string BuildClass()
    {
        var sb = new StringBuilder();
        
        if ( Health < 30f )
            sb.Append( "low-health" );
        
        return sb.ToString();
    }
}
